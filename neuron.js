var Network;Network=function(){var t,e,n,r,i,a,u,s,o,d,l,f,c,h,p,x,g,v,y,m,w;i=[];r=[];p={mouseDownNode:null,shiftDrag:false};t=0;c=null;e=null;u=null;s=null;h=null;n=function(t,e,n,r){return"M"+t+","+e+"L"+n+","+r};o=d3.behavior.drag().origin(function(t){return t}).on("drag",function(t){if(p.shiftDrag){return h.attr("d",n(t.x,t.y,d3.mouse(s.node())[0],d3.mouse(s.node())[1]))}else{t.x=d3.event.x;t.y=d3.event.y;d3.select(this).select("circle").attr("cx",t.x).attr("cy",t.y);d3.select(this).select("text").attr("x",t.x).attr("y",t.y);return y()}});a=function(t,r,i){u=d3.select(t);s=u.append("svg").attr("width","100%").attr("height","100%");h=s.append("svg:path").attr("class","link").attr("d",n(0,0,0,0));e=s.append("g").attr("id","edges");c=s.append("g").attr("id","nodes");s.on("dblclick",x);s.on("mousedown",g);s.on("mouseup",v);return y()};x=function(){var e,n;if(d3.event.defaultPrevented){return}e=d3.mouse(s.node());n={id:t++,x:e[0],y:e[1]};i.push(n);return y()};g=function(){};v=function(){if(p.shiftDrag){h.classed("hidden",true);return p.shiftDrag=false}};d=function(t){d3.event.stopPropagation();p.mouseDownNode=t;if(d3.event.shiftKey){p.shiftDrag=true;return h.classed("hidden",false).attr("d",n(t.x,t.y,t.x,t.y))}};l=function(t){var e,n,i;p.shiftDrag=false;i=p.mouseDownNode;if(!i){return}if(p.mouseDownNode!==t){e={start:i,finish:t};n=r.filter(function(t){if(t.start===e.finish&&t.finish===e.start){r.splice(r.indexOf(t))}return t.start===e.start&&t.finish===e.finish});if(n.length===0){r.push(e);console.log(JSON.stringify(r));y()}}return h.classed("hidden",true)};f=function(t){var e;d3.event.preventDefault();e=0;while(e<i.length){if(i[e].id===t.id){i.splice(e,1);break}else{e+=1}}return y()};w=function(){var t,e;e=c.selectAll("g").data(i,function(t){return t.id});t=e.enter().append("g").on("contextmenu",f).on("mousedown",d).on("mouseup",l).call(o);t.append("circle");t.append("text");e.select("text").attr("x",function(t){return t.x+"px"}).attr("y",function(t){return t.y+"px"}).attr("fill","black");e.select("circle").attr("cx",function(t){return t.x+"px"}).attr("cy",function(t){return t.y+"px"}).attr("r","40").attr("fill","white").attr("stroke","black").attr("stroke-width","3");e.attr("id",function(t){return t.id});return e.exit().remove()};m=function(){var t;t=e.selectAll("path").data(r,function(t){return t.start.id+"+"+t.finish.id});t.enter().append("path").classed("link",true);return t.attr("d",function(t){return n(t.start.x,t.start.y,t.finish.x,t.finish.y)})};y=function(){w();return m()};return a};$(function(){var t;t=Network();return t("#neuron",[],[])});